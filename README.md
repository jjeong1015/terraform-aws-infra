# π€ Terraformμ„ ν™μ©ν• AWS μΈν”„λΌ κµ¬μ¶•

## π“ Terraformμ΄λ€?
**Terraform**μ€ HashiCorpμ—μ„ κ°λ°ν• **μ¤ν”μ†μ¤ μΈν”„λΌμ¤νΈλ­μ² μ½”λ“(IaC, Infrastructure as Code) λ„κµ¬**μ…λ‹λ‹¤.
AWS, Azure, GCPμ™€ κ°™μ€ ν΄λΌμ°λ“ μΈν”„λΌλ¥Ό μ½”λ“λ΅ μ •μν•κ³  κ΄€λ¦¬ν•  μ μλ„λ΅ λ„μ™€μ¤λ‹λ‹¤.

<br>

## π›  Terraformμ μ‘λ™ λ°©μ‹
Terraformμ€ **μ„ μ–Έν•(Declarative)** λ°©μ‹μΌλ΅ μΈν”„λΌλ¥Ό μ •μν•κ³  κ΄€λ¦¬ν•©λ‹λ‹¤.
μ¦‰, "μ–΄λ–¤ μƒνƒμ μΈν”„λΌλ¥Ό μ›ν•λ”μ§€"λ¥Ό μ½”λ“λ΅ μ‘μ„±ν•λ©΄ Terraformμ΄ μ΄λ¥Ό μλ™μΌλ΅ κµ¬μ„±ν•κ³  μ΅°μ •ν•©λ‹λ‹¤.

### π—οΈ μ£Όμ” λ™μ‘ μ›λ¦¬
1. **Terraform Init (`terraform init`)**
   - Terraform ν”„λ΅μ νΈλ¥Ό μ΄κΈ°ν™”ν•κ³  ν•„μ”ν• ν”λ¬κ·ΈμΈμ„ λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤.
2. **Terraform Plan (`terraform plan`)**
   - μ‹¤ν–‰ μ „μ— μ–΄λ–¤ λ³€κ²½ μ‚¬ν•­μ΄ μ μ©λ μ§€ λ―Έλ¦¬ ν™•μΈν•  μ μμµλ‹λ‹¤.
3. **Terraform Apply (`terraform apply -auto-approve`)**
   - μ •μν• μΈν”„λΌλ¥Ό μ‹¤μ  AWS ν™κ²½μ— μ μ©ν•©λ‹λ‹¤.
4. **Terraform Destroy (`terraform destroy`)**
   - μƒμ„±λ λ¨λ“  λ¦¬μ†μ¤λ¥Ό μ κ±°ν•©λ‹λ‹¤.

<br>

## β… Terraformμ„ μ‚¬μ©ν•λ” μ΄μ 
1. **μλ™ν™”λ μΈν”„λΌ κ΄€λ¦¬**
   - ν΄λ¦­ λ‡ λ²μΌλ΅ λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•λ” κ²ƒμ΄ μ•„λ‹λΌ, μ½”λ“λ¥Ό ν†µν•΄ μΈν”„λΌλ¥Ό μλ™μΌλ΅ μƒμ„±, μμ •, μ‚­μ ν•  μ μμµλ‹λ‹¤.
2. **λ²„μ „ κ΄€λ¦¬ κ°€λ¥**
   - Gitκ³Ό κ°™μ€ λ²„μ „ κ΄€λ¦¬ μ‹μ¤ν…κ³Ό κ²°ν•©ν•μ—¬ μΈν”„λΌ λ³€κ²½ μ‚¬ν•­μ„ μ¶”μ ν•  μ μμµλ‹λ‹¤.
3. **μΌκ΄€μ„± μ μ§€**
   - λ™μΌν• μ½”λ“λ¥Ό μ‚¬μ©ν•λ©΄ κ°λ°, ν…μ¤νΈ, μ΄μ ν™κ²½μ—μ„ μΌκ΄€λ μΈν”„λΌ κµ¬μ„±μ΄ κ°€λ¥ν•©λ‹λ‹¤.
4. **λΉ λ¥Έ λ°°ν¬**
   - μ½”λ“ ν• μ¤„λ§ μμ •ν•λ©΄ μ „μ²΄ μΈν”„λΌκ°€ λ³€κ²½λλ―€λ΅ ν¨μ¨μ μΈ μ΄μμ΄ κ°€λ¥ν•©λ‹λ‹¤.

<br>

## π AWS μΈν”„λΌ κµ¬μ„± νμΌ μ„¤λ…
### π“ μ£Όμ” Terraform νμΌ λ° μ—­ν• 

| νμΌλ… | μ—­ν•  |
|--------|------------------------------------------------------------------|
| `provider.tf` | Terraformμ΄ AWSμ™€ μƒνΈμ‘μ©ν•  μ μλ„λ΅ AWS Providerλ¥Ό μ„¤μ •ν•©λ‹λ‹¤. |
| `ec2.tf` | EC2 μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•κ³  μ„¤μ •ν•©λ‹λ‹¤. |
| `s3.tf` | S3 λ²„ν‚·μ„ μƒμ„±ν•κ³  μ„¤μ •ν•©λ‹λ‹¤. |
| `iampolicy.tf` | EC2 μΈμ¤ν„΄μ¤κ°€ S3μ— μ ‘κ·Όν•  μ μλ„λ΅ IAM μ—­ν• κ³Ό μ •μ±…μ„ μ„¤μ •ν•©λ‹λ‹¤. |
| `endpoint.tf` | VPC μ—”λ“ν¬μΈνΈλ¥Ό μƒμ„±ν•μ—¬ EC2μ™€ S3 κ°„μ ν†µμ‹ μ„ μµμ ν™”ν•©λ‹λ‹¤. |
| `upload_main.tf` | S3μ— μ—…λ΅λ“ν•  HTML νμΌμ„ κ΄€λ¦¬ν•λ” μ£Όμ” μ„¤μ • νμΌμ…λ‹λ‹¤. |
| `upload_new_index.tf` | μƒλ΅μ΄ HTML νμΌμ„ μƒμ„±ν•κ±°λ‚ κΈ°μ΅΄ μΈλ±μ¤ νμΌμ„ μ—…λ°μ΄νΈν•©λ‹λ‹¤. |
| `modify_index.tf` | AWS λ¦¬μ†μ¤λ‚ HTML νμΌμ μΈλ±μ¤λ¥Ό μμ •ν•κ±°λ‚ κ°±μ‹ ν•©λ‹λ‹¤. |
| `iampolicy2.tf` | EC2 μΈμ¤ν„΄μ¤κ°€ S3μ— μ ‘κ·Όν•  μ μλ” IAM μ—­ν• κ³Ό μ •μ±…μ„ μ„¤μ •ν•©λ‹λ‹¤. |
| `vpc.tf` | AWS λ„¤νΈμ›ν¬ μΈν”„λΌλ¥Ό μ„ν• VPCλ¥Ό μƒμ„±ν•©λ‹λ‹¤. |
| `web-subnets.tf` | μ™Έλ¶€μ—μ„ μ ‘κ·Ό κ°€λ¥ν• λ‘ κ°μ νΌλΈ”λ¦­ μ„λΈλ„·μ„ μƒμ„±ν•©λ‹λ‹¤. |
| `subnets.tf` | λ‘ κ°μ ν”„λΌμ΄λΉ— μ• ν”λ¦¬μΌ€μ΄μ… μ„λΈλ„·μ„ μƒμ„±ν•©λ‹λ‹¤. |
| `internet-gw.tf` | VPCκ°€ μΈν„°λ„·μ— μ—°κ²°λ  μ μλ„λ΅ μΈν„°λ„· κ²μ΄νΈμ›¨μ΄λ¥Ό μƒμ„±ν•©λ‹λ‹¤. |
| `eip.tf` | NAT κ²μ΄νΈμ›¨μ΄μ— μ‚¬μ©ν•  Elastic IPλ¥Ό μƒμ„±ν•©λ‹λ‹¤. |
| `nat-gw.tf` | ν”„λΌμ΄λΉ— μ„λΈλ„·μ μ™Έλ¶€ ν†µμ‹ μ„ μ„ν•΄ NAT κ²μ΄νΈμ›¨μ΄λ¥Ό μƒμ„±ν•©λ‹λ‹¤. |
| `public-rt.tf` | νΌλΈ”λ¦­ μ„λΈλ„·μ—μ„ μΈν„°λ„· κ²μ΄νΈμ›¨μ΄λ¥Ό ν†µν•΄ μΈν„°λ„·μΌλ΅ λ‚κ°€λ” λΌμ°ν… ν…μ΄λΈ”μ„ μ„¤μ •ν•©λ‹λ‹¤. |
| `private-rt.tf` | ν”„λΌμ΄λΉ— μ„λΈλ„·μ—μ„ NAT κ²μ΄νΈμ›¨μ΄λ¥Ό ν†µν•΄ μΈν„°λ„·μΌλ΅ λ‚κ°€λ” λΌμ°ν… ν…μ΄λΈ”μ„ μ„¤μ •ν•©λ‹λ‹¤. |

<br>

## π“ Terraform λ…λ Ήμ–΄ μ •λ¦¬
```sh
# AWS CLI λ²„μ „ ν™•μΈ
$ aws --version

# Terraform μ„¤μΉ
$ sudo -i
# HashiCorp GPG Key μ¶”κ°€
# (Ubuntu κΈ°μ¤€ μ„¤μΉ)
$ wget -O- https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
$ echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/hashicorp.list
$ apt-get update && apt-get install terraform -y
$ terraform -version
$ exit

# Terraform μ΄κΈ°ν™”
$ terraform init

# λ³€κ²½ μ‚¬ν•­ λ―Έλ¦¬ λ³΄κΈ°
$ terraform plan

# λ³€κ²½ μ‚¬ν•­ μ μ©
$ terraform apply -auto-approve

# λ¦¬μ†μ¤ μ‚­μ  (μ£Όμ ν•„μ”)
$ terraform destroy
```

<br>

## π“Ά κ²°λ΅ 
Terraformμ„ ν™μ©ν•λ©΄ **AWS μΈν”„λΌλ¥Ό μ½”λ“λ΅ κ΄€λ¦¬ν•λ©΄μ„ μλ™ν™”, μΌκ΄€μ„±, λ²„μ „ κ΄€λ¦¬λ¥Ό κ·Ήλ€ν™”ν•  μ μμµλ‹λ‹¤**.
λ³Έ ν”„λ΅μ νΈμ—μ„λ” EC2, S3, VPC λ“±μ λ¦¬μ†μ¤λ¥Ό μ •μν•μ—¬ **ν΄λΌμ°λ“ ν™κ²½μ„ ν¨μ¨μ μΌλ΅ κµ¬μ„±ν•λ” λ°©λ²•μ„ ν•™μµν•  μ μμµλ‹λ‹¤**.
